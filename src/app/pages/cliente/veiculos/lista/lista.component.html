<nav class="header-client-app">
    <span class="menu-bar" (click)="this.base.setMenu(true)">
        <i class="fa fa-bars" aria-hidden="true"></i>
    </span>
    <h6>{{ this.titlePage }}</h6>
    <div class="lista-actions">
        <i class="icon ion-md-car" aria-hidden="true" (click)="this.mapaVeiculos()"></i>
        <i class="icon ion-md-refresh" aria-hidden="true" (click)="this.refresh()"></i>
    </div>
</nav>

<div id="router-veiculos" [@routeVeiculosAnimations]="this.getRouteAnimationData()">
    <router-outlet></router-outlet>
</div>

<main [class.content-client-app]="true" [class.content-client-app-android]="this.app.platform?.toLocaleLowerCase() == 'android'" (click)="this.base.setMenu(false)">
    <div class="veiculo-search">
        <div class="input-group">
            <span class="input-group-text" id="label-search-bem">
                <i class="icon ion-md-search" aria-hidden="true"></i>
            </span>
            <input type="text" class="form-control" 
            placeholder="Placa, Motorista ou Veículo" 
            aria-label="Procure por placa, Motorista ou Veículo" 
            aria-describedby="label-search-bem"
            [(ngModel)]="this.searchValue"
            (input)="this.filterSelectBem()" />
            <span class="input-group-text" id="close-search-bem">
                <i class="icon ion-md-close" aria-hidden="true"
                *ngIf="this.searchValue" (click)="this.filterCancelSelectBem()"></i>
            </span>
        </div> 
        <div class="filter-group" (click)="this.openFilterStatus(true)">
            <span>
                <i class="icon ion-md-funnel"></i>
                <span class="count-funnel">{{filterStatus.inputsEnabled}}</span>
            </span>
        </div>
    </div>
    <div class="veiculo-card" [id]="item.id" [class.offcard]="item.status_sinal == 'D'" *ngFor="let item of this.veiculosFiltered">
        <div class="card-infos" (click)="mapaVeiculo(item)">
            <div class="infos-top">
                <div class="identificacao">
                    <span style="font-size: 1.5rem; line-height: 1.5rem;">{{item.name}}</span>
                    <span style="font-size: 0.73em; text-transform: uppercase;">{{ (item.motorista) ? '('+item.motorista+')' : '('+item.marca+')' }}</span>
                </div>

                <div class="status">
                    <div [class.bg-success]="item.ligado == 'S'"   [class.bg-danger]="item.ligado == 'N'" id="notification-button">
                        <i class="icon ion-md-key notifications-badge" 
                        [class.text-danger]="item.ligado == 'N'" [class.text-success]="item.ligado == 'S'"
                        [class.fill-danger]="item.ligado == 'N'" [class.fill-success]="item.ligado == 'S'"></i>
                        <div style="background: transparent">
                            {{  item.obj_localizacao?.date | todate:'DD/MM/yyyy HH:mm:ss'  }}
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="infos-bottom">
                <div class="local">
                    <i class="icon ion-md-pin" 
                        [class.text-danger]="item.ligado == 'N'" [class.text-success]="item.ligado == 'S'"
                        [class.fill-danger]="item.ligado == 'N'" [class.fill-success]="item.ligado == 'S'"></i>
                    <span class="endereco">{{item.endereco}}</span>
                </div>

                <div class="velocidade">
                    <div>
                        <i class="icon ion-md-speedometer" 
                            [class.text-danger]="item.ligado == 'N'" [class.text-success]="item.ligado == 'S'"
                            [class.fill-danger]="item.ligado == 'N'" [class.fill-success]="item.ligado == 'S'"></i>
                        <span>{{item.speed}}</span>
                        <span class="unidade">Km/h</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card-actions">
            <div style="text-align: center; border-top: 1px solid #EDEDED; background: white;">
                <div (click)="bloquear(item)" [hidden]="item.bloqueado=='S'">
                    <i color="iconscolor" class="fa fa-lock size-1_5"></i>
                    <span style="display: block; color:#444140">Bloquear</span>
                </div>
                <div (click)="desbloquear(item)" [hidden]="item.bloqueado=='N'">
                    <i color="iconscolor" class="fa fa-unlock-alt size-1_5"></i>
                    <span style="display: block; color:#444140">Desbloquear</span>
                </div>
                <div (click)="cercas(item)">
                    <i color="iconscolor" class="fa fa-map size-1_5"></i>
                    <span style="display: block; color:#444140">Cerca Virtual</span>
                </div>
                <div (click)="limiteVelocidade(item)">
                    <i color="iconscolor" class="fa fa-exclamation-triangle size-1_5"></i>
                    <span style="display: block;color:#444140">Velocidade Limite</span>
                </div>
            </div>
        </div>
	</div>
</main>

<div id="filter-popup" [class.opened]="this.filterStatus.opened" [class.closed]="!this.filterStatus.opened" [class.content-client-app-android]="this.app.platform?.toLocaleLowerCase() == 'android'">
    <div class="filter-overlay" (click)="this.openFilterStatus(false)"></div>
    <div class="filter-content">
        <div class="filter-header">
            <h4>Filtros</h4>
            <span class="btnFilterSave" (click)="this.saveFilterStatus()">Salvar</span>
        </div>
        <div class="filter-inputs">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="filter-ligado" [(ngModel)]="this.filterStatus.inputsTemp.ligado">
                <label class="form-check-label" for="filter-ligado">
                    Ligado <span class="filter-count">{{this.filterStatus.inputsCount.ligado}}</span>
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="filter-desligado" [(ngModel)]="this.filterStatus.inputsTemp.desligado">
                <label class="form-check-label" for="filter-desligado">
                    Desligado <span class="filter-count">{{this.filterStatus.inputsCount.desligado}}</span>
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="filter-ligado-parado" [(ngModel)]="this.filterStatus.inputsTemp.ligadoparado">
                <label class="form-check-label" for="filter-ligado-parado">
                    Ligado parado <span class="filter-count">{{this.filterStatus.inputsCount.ligadoparado}}</span>
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="filter-off-24h" [(ngModel)]="this.filterStatus.inputsTemp.off24h">
                <label class="form-check-label" for="filter-off-24h">
                    Offline +24h <span class="filter-count">{{this.filterStatus.inputsCount.off24h}}</span>
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="filter-off-48h" [(ngModel)]="this.filterStatus.inputsTemp.off48h">
                <label class="form-check-label" for="filter-off-48h">
                    Offline +48h <span class="filter-count">{{this.filterStatus.inputsCount.off48h}}</span>
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="filter-off-72h" [(ngModel)]="this.filterStatus.inputsTemp.off72h">
                <label class="form-check-label" for="filter-off-72h">
                    Offline +72h <span class="filter-count">{{this.filterStatus.inputsCount.off72h}}</span>
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="filter-off-7d" [(ngModel)]="this.filterStatus.inputsTemp.off7d">
                <label class="form-check-label" for="filter-off-7d">
                    Offline +7 dias <span class="filter-count">{{this.filterStatus.inputsCount.off7d}}</span>
                </label>
            </div>
        </div>
    </div>
</div>


<div style="display: none;">
    <img src="assets/modals/bloquear.png">
    <img src="assets/modals/desbloquear.png">
    <img src="assets/modals/velocidadelimite.png">
</div>